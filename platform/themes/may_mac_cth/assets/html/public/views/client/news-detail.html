<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chi tiết tin tức - Top 10+ mẫu áo đồng phục</title>
    <link href="../../../../https@cdn.jsdelivr.net/npm/bootstrap_405.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="../../../../https@unpkg.com/boxicons_402.1.4/css/boxicons.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../../assets/css/style.css">
    <link rel="stylesheet" href="../../assets/css/news-detail.css">
</head>

<body>
    <!-- Top Header -->
    <div class="top-header bg-white border-bottom">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center">
                    <div class="dropdown me-4">
                        <button class="btn btn-sm p-0 text-muted d-flex align-items-center" type="button"
                            aria-expanded="false">

                            <img src="../../assets/images/vietnam-flag.png" id="currentFlag"
                                style="width: 20px; height: 20px; object-fit: cover; border-radius: 3px;">
                            <span id="currentLang" class="ms-1">VN</span>
                        </button>

                        <!-- <ul class="dropdown-menu" aria-labelledby="languageDropdown" style="min-width: 120px;">
                            <li>
                                <a class="dropdown-item d-flex align-items-center choose-lang" data-lang="VN"
                                    data-flag="asset/images/vietnam-flag.png" href="#">
                                    <img src="asset/images/vietnam-flag.png"
                                        style="width: 22px; height: 22px; object-fit: cover; border-radius: 3px;">
                                    <span class="ms-2">VN</span>
                                </a>
                            </li>

                            <li>
                                <a class="dropdown-item d-flex align-items-center choose-lang" data-lang="EN"
                                    data-flag="asset/images/us-flag.png" href="#">
                                    <img src="asset/images/us-flag.png"
                                        style="width: 22px; height: 22px; object-fit: cover; border-radius: 3px;">
                                    <span class="ms-2">EN</span>
                                </a>
                            </li>
                        </ul> -->
                    </div>
                    <span class="text-muted me-3"></span>
                    <!-- <a href="tel:+0783157988" class="text-muted me-4">
                        <i class="bx bx-phone-call me-1"></i> 0783 157 988
                    </a> -->
                    <span class="text-muted me-4">
                        <i class="bx bx-phone-call me-1"></i> 0783 157 988
                    </span>
                </div>
                <!-- <a href="#" class="text-muted">
                    <i class="bx bx-git-compare me-1"></i> So sánh
                </a> -->
                <!--<span class="text-muted">-->
                <!--    <i class="bx bx-git-compare me-1"></i> So sánh-->
                <!--</span>-->
            </div>
        </div>
    </div>

    <!-- Search Bar -->
    <div class="search-bar bg-white py-2">
        <div class="container">
            <div class="d-flex align-items-center justify-content-between">

                <a href="index.html">
                    <img src="../../assets/images/logo.png" alt="Logo" height="60" class="me-32">
                </a>

                <div class="d-flex align-items-center bg-white border rounded px-2"
                    style="height: 45px; position: relative;">

                    <div class="search-dropdown-wrap h-100 d-flex align-items-center position-relative">
                        <input type="hidden" id="categorySelectValue" value="">

                        <div class="search-trigger d-flex align-items-center cursor-pointer pe-3 border-end"
                            style="cursor: pointer; min-width: 130px; justify-content: space-between; height: 100%;">
                            <span id="categoryDisplayText" class="fw-bold text-dark" style="font-size: 14px;">Tất
                                cả</span>
                            <i class='bx bx-chevron-down ms-2 text-muted'></i>
                        </div>

                        <ul class="search-dropdown-list" id="searchCategoryUl">
                            <li><a href="javascript:void(0)" onclick="selectSearchCategory('', 'Tất cả')">Tất cả</a>
                            </li>
                        </ul>
                    </div>

                    <div class="search-container flex-grow-1 ms-2 d-flex align-items-center">
                        <input type="text" class="form-control border-0 shadow-none search-input" id="searchInput"
                            placeholder="Tìm kiếm sản phẩm..." aria-label="Search" style="font-size: 14px;">
                        <button class="btn border-0" type="button" id="btnSearch">
                            <i class='bx bx-search fs-5 text-primary'></i>
                        </button>
                    </div>
                </div>

                <a href="tel_3A+0783157988" class="btn btn-outline-primary px-4">
                    <i class="bx bx-phone-call me-1"></i> 0783 157 988
                </a>
            </div>
        </div>
    </div>

    <!-- Menu -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container-fluid">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto align-items-center">
                    <!-- Custom dropdown danh mục -->
                    <li class="nav-item dropdown-custom me-4">
                        <a href="#" class="nav-link text-warning d-flex align-items-center">
                            <i class="bx bx-menu me-2"></i> TẤT CẢ DANH MỤC
                        </a>
                        <ul class="dropdown-menu-custom">
                            <li><a href="#">Áo đồng phục</a></li>
                            <li><a href="#">Áo thể thao</a></li>
                            <li><a href="#">Áo + Logo áo</a></li>
                            <li><a href="#">BST + Logo áo</a></li>
                            <li><a href="#">Đồng phục công giáo</a></li>
                            <li><a href="#">Đồng phục công sở</a></li>
                            <li><a href="#">Đồng phục học tập</a></li>
                            <li><a href="#">Đồng phục mùa non</a></li>
                        </ul>
                    </li>

                    <!-- Các mục menu khác -->
                    <li class="nav-item"><a class="nav-link" href="index.html">Trang chủ</a></li>
                    <li class="nav-item"><a class="nav-link" href="about-us.html">Về chúng tôi</a>
                    </li>
                    <li class="nav-item"><a class="nav-link" href="products.html">Sản phẩm</a></li>
                    <li class="nav-item"><a class="nav-link" href="guide.html">Hướng dẫn</a></li>
                    <li class="nav-item dropdown-custom">
                        <a href="news.html" class="nav-link text-warning d-flex align-items-center">
                            Tin tức <i class='bx bx-chevron-down' style="font-size: 20px;"></i>
                        </a>
                        <ul class="dropdown-menu-custom" id="newsCategoryDropdown">
                            <li class="text-center py-3"><small class="text-muted">Đang tải danh mục...</small></li>
                        </ul>
                    </li>
                    <li class="nav-item"><a class="nav-link" href="contact.html">Liên hệ</a></li>
                </ul>

                <!-- Icon bên phải -->
                <ul class="navbar-nav ms-3">
                    <li class="nav-item" style="margin-right: 90px;">
                        <a class="nav-link" href="cart.html"
                            style="display: flex; align-items: center; justify-content: center;">

                            <div
                                style="position: relative; width: 24px !important; height: 24px !important; line-height: 24px;">

                                <i class="bx bx-cart" style="font-size: 24px; position: absolute; top: 0; left: 0;"></i>

                                <span id="cartCount" class="badge rounded-pill bg-danger"
                                    style="position: absolute; top: -6px; right: -8px; font-size: 9px; padding: 2px 4px; border: 2px solid #fff; display: none;">
                                    0
                                    <span class="visually-hidden">sản phẩm</span>
                                </span>
                            </div>

                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- MAIN CONTENT -->
    <section class="news-detail-section pb-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-8">
                    <article>
                        <h1 class="news-detail-title">Top 10+ mẫu áo đồng phục đẹp nhất 2025: Xu hướng và Phong cách
                        </h1>

                        <div class="news-meta">
                            <span><i class='bx bx-calendar'></i> 22/11/2025</span>
                            <span><i class='bx bx-user'></i> Tác giả: Admin CTH</span>
                        </div>

                        <div class="news-content">
                            <p><strong>Bạn đang tìm xưởng may áo đồng phục tại Hải Phòng đẹp, giá hợp lý nhất? Năm 2025
                                    đánh dấu sự lên ngôi của những thiết kế tối giản nhưng tinh tế, chú trọng vào chất
                                    liệu vải thoáng mát và thân thiện với môi trường.</strong></p>

                            <img src="../../assets/images/news1.png"
                                onerror="this.src='https://via.placeholder.com/800x450?text=Anh+Minh+Hoa+Bai+Viet'"
                                alt="Mẫu áo đồng phục đẹp">

                            <h3>1. Xu hướng màu sắc năm 2025</h3>
                            <p>Năm nay, các tông màu pastel nhẹ nhàng như xanh mint, hồng phấn hay vàng kem đang chiếm
                                ưu thế. Bên cạnh đó, các doanh nghiệp vẫn ưu tiên các gam màu thương hiệu mạnh mẽ như
                                Xanh Navy, Đỏ Đô để tạo dấu ấn riêng.</p>

                            <div class="quote-box">
                                "Đồng phục không chỉ là trang phục, đó là bộ mặt của thương hiệu. Một bộ đồng phục đẹp
                                giúp nhân viên tự tin hơn 200% khi giao tiếp với khách hàng."
                            </div>

                            <h3>2. Chất liệu vải "biết thở"</h3>
                            <p>Tại <strong>MAY MẶC CTH</strong>, chúng tôi ưu tiên sử dụng vải Cotton 100%, vải Cafe,
                                hoặc vải Bamboo. Ưu điểm của các loại vải này là:</p>
                            <ul>
                                <li>Khả năng thấm hút mồ hôi cực tốt.</li>
                                <li>Khử mùi kháng khuẩn tự nhiên.</li>
                                <li>Không nhăn, không xù lông sau nhiều lần giặt.</li>
                            </ul>

                            <img src="../../assets/images/news2.png"
                                onerror="this.src='https://via.placeholder.com/800x450?text=Chat+Lieu+Vai'"
                                alt="Chất liệu vải">

                            <h3>3. Top các mẫu thiết kế được ưa chuộng</h3>
                            <p>Dưới đây là danh sách các mẫu áo polo cổ bẻ, áo thun cổ tròn được các công ty công nghệ
                                và startup lựa chọn nhiều nhất trong quý đầu năm nay. Sự kết hợp giữa viền tay áo và bo
                                cổ khác màu tạo nên điểm nhấn trẻ trung.</p>


                        </div>

                        <!-- Share buttons -->
                        <div class="mt-5 pt-3 border-top">
                            <p>Hãy liên hệ ngay với chúng tôi để được tư vấn thiết kế miễn phí!</p>
                            <p class="fw-bold mb-2">Chia sẻ bài viết:</p>

                            <div class="social-buttons">
                                <button class="btn fb-btn btn-sm me-2">
                                    <i class='bx bxl-facebook-circle me-1'></i> Facebook
                                </button>
                                <button class="btn ig-btn btn-sm me-2">
                                    <i class='bx bxl-instagram me-1'></i> Instagram
                                </button>
                            </div>
                        </div>
                    </article>
                </div>
                <div class="col-lg-4 ps-lg-5 mt-5 mt-lg-0">
                    <!-- Widget tìm kiếm -->
                    <div class="mb-5">
                        <h4 class="sidebar-title">Tìm kiếm</h4>
                        <div class="input-group">
                            <input type="text" class="form-control" placeholder="Tìm bài viết...">
                            <button class="btn btn-primary"><i class='bx bx-search'></i></button>
                        </div>
                    </div>

                    <!-- Widget Tin nổi bật -->
                    <div class="mb-5">
                        <h4 class="sidebar-title">Tin tức nổi bật</h4>

                        <!-- Item 1 -->
                        <div class="related-news-item">
                            <img src="../../assets/images/news2.png"
                                onerror="this.src='https://via.placeholder.com/150'" class="related-news-img"
                                alt="Tin 2">
                            <div class="related-news-content">
                                <h5><a href="#">Bí quyết chọn size áo chuẩn cho cả công ty</a></h5>
                                <span class="related-date"><i class='bx bx-time'></i> 20/11/2025</span>
                            </div>
                        </div>

                        <!-- Item 2 -->
                        <div class="related-news-item">
                            <img src="../../assets/images/news3.png"
                                onerror="this.src='https://via.placeholder.com/150'" class="related-news-img"
                                alt="Tin 3">
                            <div class="related-news-content">
                                <h5><a href="#">Quy trình in chuyển nhiệt hiện đại tại CTH</a></h5>
                                <span class="related-date"><i class='bx bx-time'></i> 18/11/2025</span>
                            </div>
                        </div>

                        <!-- Item 3 -->
                        <div class="related-news-item">
                            <img src="../../assets/images/news1.png"
                                onerror="this.src='https://via.placeholder.com/150'" class="related-news-img"
                                alt="Tin 1">
                            <div class="related-news-content">
                                <h5><a href="#">Đồng phục công sở: Nên chọn Vest hay Polo?</a></h5>
                                <span class="related-date"><i class='bx bx-time'></i> 15/11/2025</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer class="footer bg-primary text-white py-5">
        <div class="container">
            <div class="row gy-4">
                <!-- Logo + Giới thiệu -->
                <div class="col-12 col-md-4 col-lg-3">
                    <a href="index.html"><img src="../../assets/images/logo2.png" alt="Logo"
                            class="footer-logo mb-3"></a>
                    <p class="footer-slogan">MAY MẶC CTH lắng nghe bạn!</p>
                    <p class="footer-desc">
                        Chúng tôi luôn trân trọng mọi ý kiến đóng góp của khách hàng,
                        không ngừng cải thiện để mang đến sản phẩm và dịch vụ tốt nhất.
                    </p>
                    <a href="contact.html#feedbackForm" class="btn btn-warning footer-btn">
                        ĐÓNG GÓP Ý KIẾN →
                    </a>
                    <p class="footer-tax mt-3"><strong>MÃ SỐ THUẾ:</strong> 0202167805</p>
                </div>

                <!-- Về chúng tôi -->
                <div class="col-6 col-md-4 col-lg-2">
                    <p class="footer-title">VỀ CHÚNG TÔI</p>
                    <ul class="footer-links">
                        <li><a href="about-us.html">Giới thiệu MAY MẶC CTH</a></li>
                        <li><a href="guide.html">Hướng dẫn mua hàng</a></li>
                        <li><a href="guide.html">Hướng dẫn chọn size</a></li>
                        <li><a href="guide.html">Chính sách đổi trả</a></li>
                        <li><a href="guide.html">Chính sách giao hàng</a></li>
                        <li><a href="guide.html">FAQ</a></li>
                    </ul>
                </div>

                <!-- Sản phẩm -->
                <div class="col-6 col-md-4 col-lg-2">
                    <p class="footer-title">SẢN PHẨM</p>
                    <ul class="footer-links" id="footerProductsCategories">
                        <li class="text-muted small">Đang tải...</li>
                    </ul>
                </div>

                <!-- Tin tức -->
                <div class="col-6 col-md-6 col-lg-2">
                    <p class="footer-title">TIN TỨC</p>
                    <ul class="footer-links" id="footerNewsCategories">
                        <li class="text-muted small">Đang tải...</li>
                    </ul>
                </div>

                <!-- Thông tin liên hệ + Nút liên hệ -->
                <div class="col-12 col-md-12 col-lg-3">
                    <p class="footer-title mb-3">THÔNG TIN LIÊN HỆ</p>
                    <div class="d-flex align-items-start mb-2">
                        <i class='bx bx-map text-warning me-3' style="font-size: 1.4rem; min-width: 26px;"></i>
                        <span id="footerAddress" class="text-white">Đang tải địa chỉ...</span>
                    </div>

                    <div class="d-flex align-items-start mb-2">
                        <i class='bx bx-globe text-success me-3' style="font-size: 1.4rem; min-width: 26px;"></i>
                        <span id="footerWebsite" class="text-white">Đang tải website...</span>
                    </div>

                    <div class="d-flex align-items-start mb-4">
                        <i class='bx bx-phone text-danger me-3' style="font-size: 1.4rem; min-width: 26px;"></i>
                        <span id="footerPhone" class="text-white">Đang tải số điện thoại...</span>
                    </div>

                    <div class="footer-contact-btns mt-3">
                        <a href="../../../../https@zalo.me/078315798" class="contact-card">
                            <div class="contact-icon"><img src="../../assets/images/zalo.png" alt="Zalo"></div>
                            <div class="contact-text"><span class="contact-label">TƯ VẤN QUA</span><span
                                    class="contact-value">ZALO</span></div>
                        </a>
                        <a href="tel_3A+078315798" class="contact-card">
                            <div class="contact-icon"><img src="../../assets/images/hotline.png" alt="Hotline"></div>
                            <div class="contact-text"><span class="contact-label">HOTLINE</span><span
                                    class="contact-value">0783 157 98</span></div>
                        </a>
                        <a href="tel_3A+078315798" class="contact-card">
                            <div class="contact-icon"><img src="../../assets/images/hotline.png" alt="Tại cửa hàng">
                            </div>
                            <div class="contact-text"><span class="contact-label">TẠI CỬA HÀNG</span><span
                                    class="contact-value">078315798</span></div>
                        </a>
                    </div>
                </div>
            </div>
            <hr class="footer-divider my-4">

            <!-- Thanh toán -->
            <div class="row">
                <div class="col text-center">
                    <p class="mb-2 footer-title">PHƯƠNG THỨC THANH TOÁN</p>
                    <div class="d-flex justify-content-center align-items-center gap-3">
                        <img src="../../assets/images/cash.png" height="30" alt="Cash">
                        <img src="../../assets/images/mastercard.png" height="30" alt="Mastercard">
                        <img src="../../assets/images/visa.png" height="30" alt="Visa">
                    </div>
                </div>
            </div>

            <!-- <p class="text-center mt-4 small mb-0">&copy; 2025 MAY MẶC CTH. All rights reserved.</p> -->
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="../../../../https@cdn.jsdelivr.net/npm/bootstrap_405.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const BASE_URL = '../../../MayMacCTH';

        document.addEventListener('DOMContentLoaded', async () => {
            const addressEl = document.getElementById('footerAddress');
            const websiteEl = document.getElementById('footerWebsite');
            const phoneEl = document.getElementById('footerPhone');

            if (!addressEl && !websiteEl && !phoneEl) return;

            try {
                const res = await fetch(`https://demo9.sibic.vn/api/contact/get_contact.php?t=${Date.now()}`);
                const data = await res.json();

                if (data.success && data.data && data.data.length > 0) {
                    const c = data.data[0];

                    if (addressEl) {
                        addressEl.textContent = c.address || 'Chưa cập nhật địa chỉ';
                    }

                    if (websiteEl) {
                        if (c.website && c.website.trim()) {
                            const url = c.website.match(/^https?:\/\//i) ? c.website : '../../../../https@/' + c.website;
                            websiteEl.outerHTML = `<a href="${url}" target="_blank" class="text-white text-decoration-none">${c.website}</a>`;
                        } else {
                            websiteEl.textContent = 'Chưa có website';
                        }
                    }

                    if (phoneEl) {
                        phoneEl.textContent = c.phone_number || 'Chưa cập nhật số điện thoại';
                    }
                }
            } catch (err) {
                console.error('Lỗi load footer contact:', err);
            }
            const dropdownMenu = document.querySelector('.dropdown-menu-custom');

            if (!dropdownMenu) return;

            dropdownMenu.innerHTML = '';

            try {
                const response = await fetch('../../../api/category/get_category.php@t=' + Date.now());

                if (!response.ok) {
                    throw new Error('Lỗi mạng: ' + response.status);
                }

                const result = await response.json();

                if (!result.success || !Array.isArray(result.data) || result.data.length === 0) {
                    dropdownMenu.innerHTML = '<li><a href="#" class="dropdown-item text-muted">Chưa có danh mục</a></li>';
                    return;
                }

                const activeCategories = result.data.filter(cat =>
                    cat.is_active === undefined || cat.is_active == 1 || cat.is_active === '1'
                );

                if (activeCategories.length === 0) {
                    dropdownMenu.innerHTML = '<li><a href="#" class="dropdown-item text-muted">Không có danh mục nào hiển thị</a></li>';
                    return;
                }

                activeCategories.sort((a, b) => (a.sort_order || 0) - (b.sort_order || 0));

                activeCategories.forEach(category => {
                    const li = document.createElement('li');
                    const a = document.createElement('a');

                    a.href = `../../../public/views/client/products.html?category=${category.category_id}`;
                    a.textContent = category.name.trim();
                    a.className = 'dropdown-item';

                    li.appendChild(a);
                    dropdownMenu.appendChild(li);
                });
            } catch (err) {
                console.error('Lỗi load danh mục:', err);
                dropdownMenu.innerHTML = '<li><a href="#" class="dropdown-item text-danger">Lỗi tải danh mục</a></li>';
            }
            
            await loadSearchCategories();

            const searchWrap = document.querySelector('.search-dropdown-wrap');
            const searchTrigger = document.querySelector('.search-trigger');
            const searchList = document.getElementById('searchCategoryUl');

            if (searchWrap && searchTrigger && searchList) {
                searchTrigger.addEventListener('click', (e) => {
                    e.stopPropagation(); 
                    searchList.classList.toggle('show');
                });

                document.addEventListener('click', (e) => {
                    if (!searchWrap.contains(e.target)) {
                        searchList.classList.remove('show');
                    }
                });
            }
            const btnSearch = document.getElementById('btnSearch');
            const searchInput = document.getElementById('searchInput');

            const performSearch = () => {
                const keyword = searchInput.value.trim();
                const categoryId = document.getElementById('categorySelectValue').value;

                let url = 'products.html';
                const params = new URLSearchParams();

                if (keyword) params.append('q', keyword);
                if (categoryId) params.append('category', categoryId);

                if (params.toString()) url += '?' + params.toString();
                window.location.href = url;
            };

            if (btnSearch) btnSearch.addEventListener('click', performSearch);
            if (searchInput) searchInput.addEventListener('keypress', e => {
                if (e.key === 'Enter') performSearch();
            });
            updateCartCount();
        });
        
        function selectSearchCategory(id, name) {
            document.getElementById('categoryDisplayText').innerText = name;
            document.getElementById('categorySelectValue').value = id;

            const searchList = document.getElementById('searchCategoryUl');
            if (searchList) searchList.classList.remove('show');
        }
        async function loadSearchCategories() {
            const ulList = document.getElementById('searchCategoryUl');
            if (!ulList) return;
            ulList.innerHTML = '<li><a href="javascript:void(0)" onclick="selectSearchCategory(\'\', \'Tất cả\')">Tất cả</a></li>';

            try {
                const response = await fetch('../../../api/category/get_category.php@t=' + Date.now());

                if (!response.ok) throw new Error('Lỗi kết nối API');

                const result = await response.json();

                if (result.success && Array.isArray(result.data)) {
                    let categories = result.data;
                    categories.sort((a, b) => a.name.localeCompare(b.name));

                    categories.forEach(category => {
                        const li = document.createElement('li');
                        const a = document.createElement('a');
                        a.href = "javascript:void(0)";
                        const catName = category.name.trim();
                        a.textContent = catName;
                        a.onclick = () => selectSearchCategory(category.category_id, catName);

                        li.appendChild(a);
                        ulList.appendChild(li);
                    });
                } else {
                    console.warn("API trả về thành công nhưng không có dữ liệu danh mục nào.");
                }
            } catch (err) {
                console.error('Lỗi load danh mục:', err);
            }
        }
        
         function updateCartCount() {
            const cart = JSON.parse(localStorage.getItem('cart') || '[]');
            const totalItems = cart.length;

            const el = document.getElementById('cartCount');
            if (el) {
                el.textContent = totalItems;
                el.style.display = totalItems > 0 ? 'block' : 'none';
            }
        }

        function getSlugFromURL() {
            const params = new URLSearchParams(window.location.search);
            return params.get('slug');
        }

        function renderContent(blocks) {
            if (!blocks || blocks.length === 0) return '<p>Nội dung đang được cập nhật...</p>';

            return blocks.map(block => {
                switch (block.type) {
                    case 'header':
                        return `<h${block.data.level} class="mt-5 mb-3 fw-bold">${block.data.text}</h${block.data.level}>`;
                    case 'paragraph':
                        return `<p class="mb-4">${block.data.text}</p>`;
                    case 'image':
                        let imgSrc = block.data.file.url || '';
                        if (imgSrc && !imgSrc.startsWith('http')) {
                            imgSrc = imgSrc.replace(/^\/MayMacCTH\/+/g, '');   
                            if (imgSrc.startsWith('/')) imgSrc = imgSrc.slice(1);
                            imgSrc = '../../../' + imgSrc;
                        }
                    
                        const caption = block.data.caption
                            ? `<figcaption class="text-center text-muted fst-italic mt-2">${block.data.caption}</figcaption>`
                            : '';
                    
                        return `
                        <figure class="text-center my-3">
                            <img src="${imgSrc}"
                                 alt="${block.data.caption || 'Hình ảnh bài viết'}"
                                 class="img-fluid rounded shadow-sm"
                                 style="max-height: 550px;"
                                 loading="lazy"
                                 onerror="this.onerror=null; this.src='../../assets/images/no-image.jpg';">
                            ${caption}
                        </figure>`;
                    case 'list':
                        const items = block.data.items.map(item => `<li>${item}</li>`).join('');
                        return block.data.style === 'ordered'
                            ? `<ol class="list-styled mb-4">${items}</ol>`
                            : `<ul class="list-styled mb-4">${items}</ul>`;
                    case 'quote':
                        return `
                        <blockquote class="quote-box p-4 bg-light border-start border-primary border-5 rounded my-5">
                            <p class="mb-3 fst-italic">${block.data.text}</p>
                            ${block.data.caption ? `<footer class="text-end text-muted">— ${block.data.caption}</footer>` : ''}
                        </blockquote>`;
                    case 'embed':
                        return `<div class="ratio ratio-16x9 my-5"><iframe src="${block.data.embed}" allowfullscreen></iframe></div>`;
                    default:
                        return '';
                }
            }).join('');
        }

        async function loadArticle() {
            const slug = getSlugFromURL();
            if (!slug) {
                document.querySelector('article').innerHTML = '<h3 class="text-danger">Không tìm thấy bài viết!</h3>';
                return;
            }

            document.querySelector('article').innerHTML = `
            <div class="text-center py-5">
                <div class="spinner-border text-primary" style="width:3rem;height:3rem;"></div>
                <p class="mt-3">Đang tải bài viết...</p>
            </div>`;

            try {
                const res = await fetch(`https://demo9.sibic.vn/api/news/get_news.php?slug=${slug}`);
                const data = await res.json();

                if (!data.success || !data.data) {
                    document.querySelector('article').innerHTML = '<h3>Bài viết không tồn tại!</h3>';
                    return;
                }

                const a = data.data;
                document.title = a.title + " - MAY MẶC CTH";
                document.querySelector('article').innerHTML = `
                <h1 class="news-detail-title">${a.title}</h1>
                
                <div class="news-meta mb-4">
                    <span><i class='bx bx-calendar'></i> ${new Date(a.created_at).toLocaleDateString('vi-VN')}</span>
                    <span class="ms-4"><i class='bx bx-user'></i> ${a.author || 'Admin CTH'}</span>
                </div>

                <div class="news-content fs-5 lh-lg">
                    ${renderContent(JSON.parse(a.content || '{"blocks":[]}').blocks)}
                </div>

                <div class="mt-5 pt-4 border-top">
                    <p class="lead">Hãy liên hệ ngay để được tư vấn thiết kế đồng phục miễn phí!</p>
                    <p class="fw-bold mb-2">Chia sẻ bài viết:</p>
                    
                    <div class="social-buttons">
                        <button class="btn fb-btn btn-sm me-3" title="Chia sẻ lên Facebook" onclick="window.open('../../../../https@www.facebook.com/sharer/sharer.php@u=' + encodeURIComponent(window.location.href), '_blank')">
                            <img src="../../assets/images/facebook.png" alt="Facebook Icon" class="social-icon">
                        </button>
                        
                        <button class="btn ig-btn btn-sm" title="Sao chép link bài viết" onclick="navigator.clipboard.writeText(window.location.href);">
                            <img src="../../assets/images/instagram.png" alt="Instagram Icon" class="social-icon">
                        </button>
                    </div>
                </div>
            `;

                loadRelatedNews(a.id);

            } catch (err) {
                console.error(err);
                document.querySelector('article').innerHTML = '<h3>Lỗi tải bài viết. Vui lòng thử lại!</h3>';
            }
        }

        async function loadRelatedNews(currentId) {
            try {
                const res = await fetch(`https://demo9.sibic.vn/api/news/get_news.php`);
                const data = await res.json();
                if (!data.success || !data.data) return;

                const related = data.data
                    .filter(item => item.is_published == 1 && item.id != currentId)
                    .sort(() => Math.random() - 0.5)
                    .slice(0, 3);

                const container = document.querySelector('#relatedNews') || document.createElement('div');
                container.innerHTML = related.length > 0 ? related.map(item => `
                <div class="related-news-item mb-4 pb-3 border-bottom">
                    ${item.thumbnail ? `<img src="../../../${item.thumbnail}" class="related-news-img" alt="${item.title}">` : ''}
                    <div class="related-news-content">
                        <h5><a href="${BASE_URL}/pages/news-detail.html?slug=${item.slug}">${item.title}</a></h5>
                        <span class="related-date"><i class='bx bx-time'></i> ${new Date(item.created_at).toLocaleDateString('vi-VN')}</span>
                    </div>
                </div>
            `).join('') : '<p class="text-muted">Chưa có tin liên quan.</p>';

            } catch (err) {
                console.error('Lỗi load tin liên quan:', err);
            }
        }

        document.addEventListener('DOMContentLoaded', loadArticle);
        async function loadFooterNewsCategories() {
            const container = document.getElementById('footerNewsCategories');
            if (!container) return;

            try {
                const res = await fetch('../../../api/news/get_news_categories.php');
                const result = await res.json();

                // Xóa nội dung cũ
                container.innerHTML = '';

                if (result.success && result.data && result.data.length > 0) {
                    result.data.forEach(cat => {
                        const li = document.createElement('li');
                        const a = document.createElement('a');

                        a.href = `/public/views/client/news.html?id=${cat.id}`;
                        a.textContent = cat.name;
                        li.appendChild(a);
                        container.appendChild(li);
                    });
                } else {
                    container.innerHTML = '<li class="text-muted small">Chưa có danh mục</li>';
                }
            } catch (err) {
                console.error('Lỗi load danh mục footer:', err);
                container.innerHTML = '<li class="text-danger small">Lỗi tải danh mục</li>';
            }
        }
        async function loadFooterProductsCategories() {
            const container = document.getElementById('footerProductsCategories');
            if (!container) return;

            try {
                const res = await fetch('../../../api/category/get_category.php@t=' + Date.now());
                const result = await res.json();

                // Xóa nội dung cũ
                container.innerHTML = '';

                if (result.success && Array.isArray(result.data) && result.data.length > 0) {
                    
                    let categories = result.data;
                    categories.sort((a, b) => a.name.localeCompare(b.name));

                    categories.forEach(cat => {
                        const li = document.createElement('li');
                        const a = document.createElement('a');
                        a.href = `/public/views/client/products.html?category=${cat.category_id}`;
                        a.textContent = cat.name.trim();
                        li.appendChild(a);
                        container.appendChild(li);
                    });
                } else {
                    container.innerHTML = '<li class="text-muted small">Chưa có danh mục</li>';
                }
            } catch (err) {
                console.error('Lỗi load danh mục footer:', err);
                container.innerHTML = '<li class="text-danger small">Lỗi tải danh mục</li>';
            }
        }
        document.addEventListener('DOMContentLoaded', () => {
            loadFooterNewsCategories();
            loadNewsCategoriesDropdown();
            loadFooterProductsCategories();
        });
        async function loadNewsCategoriesDropdown() {
            const dropdown = document.getElementById('newsCategoryDropdown');
            if (!dropdown) return;

            try {
                const res = await fetch('../../../api/news/get_news_categories.php');
                const result = await res.json();

                // Xóa loading
                dropdown.innerHTML = '';

                if (result.success && result.data && result.data.length > 0) {
                    result.data.forEach(cat => {
                        const li = document.createElement('li');
                        const a = document.createElement('a');

                        a.href = `/public/views/client/news.html?id=${cat.id}`;
                        a.textContent = cat.name;
                        li.appendChild(a);
                        dropdown.appendChild(li);
                    });
                } else {
                    dropdown.innerHTML = '<li class="text-center py-3"><small class="text-muted">Chưa có danh mục tin tức</small></li>';
                }
            } catch (err) {
                console.error('Lỗi load danh mục tin tức:', err);
                dropdown.innerHTML = '<li class="text-center py-3 text-danger"><small>Lỗi tải dữ liệu</small></li>';
            }
        }
    </script>
</body>

</html>